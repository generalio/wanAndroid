## 寒假考核

### App介绍

我的寒假考核是写了一个简易的玩Android应用，界面的整体布局是参考了学长发的玩Android的布局(感谢学长提供的思路!!!)，语言是用的Kotlin(花了两天左右跟着第一行代码学的，感觉掌握程度还不太够)，架构是使用的MVP，是在写完一大堆屎山代码后根据某位超厉害的学长推荐的博客学习后改的~~(感觉代码越改越抽象了)~~。网络请求用的okhttp3,json的解析用的gson。

#### 设计思路

##### 整体布局

先是做的整体的一个界面布局，用的`TabLayout+DrawerLayout`实现的一个顶栏+抽屉布局的样式，抽屉里面的布局是上网搜索了解到一个`NavigationView`的布局能很好的实现，实现了登录/登出功能以及展示一部分个人信息，下面的列表加了一个关于功能~~(有点像为了使用这个列表功能而加了这样一个页面)~~。而主要的界面使用的是`BottomNavigationView+ViewPager2`(再次感谢学长让我知道有这么多好看又实用的控件)，通过按钮的点击来切换不同的fragment来切换页面(为了解决轮播图的滑动和ViewPager2的滑动之间的矛盾我直接把Viewpager2的滑动给禁用了)

![界面设计](.\show\界面设计.gif)

##### 主页界面

主页界面这个fragment是用的轮播图加文章列表的形式，轮播图是用的`Viewpager2`展示，然后用`Glide`来加载图片资源，在图片上面加了个蒙版图层来展示标题，三个点能展示当前轮播图所处位置，三个点是用的自定义View里面的`Ondraw`方法(照猫画虎的方式写出来的)。而轮播图的滑动则有自动三秒一轮播和手动滑动两种方式。下面的文章列表就是普通的`RecyclerView+CardView`实现的，点击卡片后能跳转对应的网址(WebView)。因为WanAndroid的接口里面有个`page`参数，所以在不断的叨扰学长后，监听当`RecyclerView`滑动到最底部后能动态加载新的文章数据，然后把Adapter的继承换成了`listAdapter`实现了差分刷新~~(只是知道了如何使用，并不知道原理qaq)~~。

![主页展示](.\show\主页功能.gif)

##### 公众号界面

公众号界面使用的是`TabLayout+RecyclerView`的布局，针对学长提供的`ViewPager2+RecyclerView`的布局进行了修改~~(绝对不是为了偷懒)~~。如果使用fragment的话则需要对每一个作者都新添一个fragment，并且如果后面作者的列表更新的话又得不断新增，于是我设计的是在TabLayout上切换作者时对RecyclerView全局刷新来模仿一个切换的效果，文章的展示则跟主页的模板一模一样。

![公众号展示](.\show\公众号功能.gif)

##### 导航界面

导航界面我是用的`RecyclerView+RecyclerView`的左右布局的模式，左边的RecyclerView来加载导航列表，监听点击时更改背景以及文字颜色来模拟被选中的情况。当点击后，在第六次课中曾经讲过可以在Adapter里面注册点击接口来实现在外部注册点击事件。我用这个来实现了点击后能切换不同的导航，右边能展示不同的列表数据。右边的每个导航网站的展示同样用单纯的RecyclerView来代替`ViewPager2+Fragment`，故无法达到像玩Android官方App所实现的能向下滑动自动切换的功能。右边的RecyclerView用了流式布局，每个导航也是用的CardView展示，点击后也可以进行跳转。

![导航展示](.\show\导航功能.gif)

##### 登录以及注册界面

前往登录的按钮放在了抽屉栏里，登录/注册的布局基本上就是直接照抄第五节课的作业，然后添加了一些错误信息的提示(如登录时账户或密码为空，注册时两次输入的密码不相同等)，以及监听了当用户重新开始输入时能取消提示。同时还对登录/注册请求后，如返回有错误信息(如密码不对或账号已被注册)用了`AlertDialog`进行提示。当登录成功后会自动返回并更新抽屉栏的一些个人信息，并将登录按钮切换成登出(在点击登出时，也会进行提示是否确认登出)。

![注册登录展示](.\show\注册登录功能.gif)

![登出功能](.\show\登出功能.gif)

##### 搜索界面

搜索界面跟前面的差不多了，顶部是两个按钮加一个搜索框，输入搜索的文字后点击搜索按钮，下面就会加载RecyclerView文章列表，同样能点击跳转下滑加载,重新输入搜索词后再点击搜索也能重新加载(要吐槽的是wanAndroid在title字段里面还使用了html，问过AI才知道渲染html的方法。他的本意应该是用html斜体来强调搜索的关键词/(ㄒoㄒ)/~~)。

![搜索展示](.\show\搜索功能.gif)

#### 待提升优化的地方

1. 登录状态没有很好的利用。因为登录后会自动把username和password保存到Cookie中，但是我自己不会，上网查询后也没有能成功。如果成功后能实现自动登录(现在app的自动登录是个伪的Cookie)
2. 收藏功能。一开始是有打算做收藏功能的，但是因为上一条登录的原因，如果没有做持久化Cookie的话，文章返回的collect字段是永远为false的，即无法知道是否收藏以及进行收藏功能(现在想想，其实可以用sharedPreference做本地收藏，但这好像又无法和其他端联动,也没啥意义)。

### 心得体会

​		其实感觉自己的大一上还是挺摆烂的，网校的学习也是仅仅跟着讲的进度走，其他东西几乎没去看过，感觉真正花在安卓上的时间远没有其他同学多。当寒假一开始，接到了考核任务时，感觉凭自己的能力根本不相信能写出一个完整的APP。一开始甚至不知道自己应该写啥，一片迷茫。感觉就像昨天还在造轮子，今天就要开始造车子了。最后想到学长曾经发过一篇关于wanAndroid的布局后，便决定要仿写wanAndroid了。但决定了却不知道从何下手，便决定从学长们推荐的第一行代码开始入手。又看到书里面用的Kotlin，索性直接开始先学Kotlin。当时甚至出去旅游的路上还带着第一行代码，然后零零散散的看了下用kotlin写的上学期讲的东西，感觉对kotlin有一点模糊的感觉了，便开始着手于考核内容，当时已经快过年了，仍是每天睡到中午起来就坐在桌子上不断写。中途遇到过许多不知道的控件的用法，都是在不断查找以及在学长的帮助下一步一步的完善的。比起考核，感觉更像一种学习的过程，让我意识到自己目前能力的缺陷，包括知识储备以及效率来说都是远远不足的，但在这个过程中体会到了自己的进步，从一开始要花好几天才能完成的一个整体框架和一个页面，到后来的逐渐熟练，能在两天甚至一天就能完成一个页面，还是挺开心的吧。甚至到现在发现自己已经完成了一个相对完整的一个APP，有点难以置信这真的是自己写出来的吗。

​		感谢红岩，能让我在大一上逐渐明确自己的目标，而不是无所事事，不知道干什么，不然寒假估计就是天天睡觉-打游戏-睡觉了。虽然现在自己的能力还有限，包括控件的用法目前也是写了之后很容易忘掉，练习不够多，以及有一大堆新的各种各样的知识还需要学习，但相信现在的我不同于以往，有足够的动力去学习下去，希望在之后自己能变得更优秀。也很感谢学长们，无论是拉我入坑，或者是不厌其烦的解答我的问题，都在不断引导着我前进。

​		自己在后面也会不断学习新的知识，包括控件、kotlin语言的用法以及mvvm框架等新的技术，同时也会去复习一下自己薄弱的一些地方，比如自己对线程的理解还不够充分。在写轮播图的滑动时，费了好多时间去查资料等等才理解handler和runnable，包括后来发现手动滑动后再次进入自动轮播时会越来越快，问了AI才知道会把许多runnable塞进主线程导致堆积。这次考核既是学习的过程，也是复习的过程吧(还好发现自己的薄弱了)。

#### 对MVP架构的一点自己的理解

​		这次考核中后面改成了MVP架构，MVP分为`MOdel,Presenter,View`层，这种架构一是为了减少`Activity/Fragment`的代码量，但是这却增加整体项目的代码量。二是能降低`Model`层和`View`层间的耦合性，不同于MVC的Model层直接通知View层进行修改，而是采用了`Presenter`这个中间层传递，能更好的解放Model层，可能修改和设计也会更加简便。而对我自己而言，MVP这种架构不同于之前的一个Activity写到底，他是从一开始就设计好整体思路，分`Model,Presenter,View`三层设计，从设计上来说也更容易和清晰（因为我的搜索界面就是直接用MVP写的）。当然，这是我自己的一点理解，肯定不怎么正确~~(胡言乱语罢了)~~。听学长说，把MVP当成过度就行了，希望自己后面能理解MVVM之类的吧(doge

